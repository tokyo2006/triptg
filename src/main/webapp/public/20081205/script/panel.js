function Panel(B,A){if(!document.body){throw new Error(["Panel","create error","Document body not found or not loaded!"]);}return this._initPanel.apply(this,arguments);}Panel.prototype=(function(){var B=100;var A=0;return{useIframe:null,draggable:false,resizable:false,panelRect:{},PANEL_CLASS:"panel",IFRAME_CLASS:"panel-iframe",INNER_CLASS:"panel-content",_panel:null,_visible:false,_inner:null,_iframe:null,_initialized:false,_initPanel:function(D,C){if(this._initialized){return this;}if(Dom.isElement(D)){this.renderPanel(D);Object.extendJson(this,C||{});}else{Object.extendJson(this,D||{});this._createPanel();}this.setPanelVisible(false);this._initialized=true;if(!this._panel.id){this._panel.id="BAIDU_PANEL_"+(A++);}return this;},_createPanel:function(){this._panel=Dom.createElement("div","className",this.PANEL_CLASS);this._inner=Dom.createElement("div","className",this.INNER_CLASS);this._panel.appendChild(this._inner);if(this.useIframe){this._createIframe();}document.body.appendChild(this._panel);},setStyle:function(D,C){Dom.setStyle(this._panel,D,C);return this;},addClassName:function(C){Dom.addClassName([this._panel,this._iframe],C);},resetClassName:function(){this._panel.className=this.PANEL_CLASS;},getPanel:function(){return this._panel;},getIframe:function(){return this._iframe;},_createIframe:function(){this._iframe=Dom.createElement("iframe",{className:this.IFRAME_CLASS,frameBorder:0,src:(window.location.protocol.toLowerCase()=="http:"?"about:blank":BB.JSPATH+"util/panel/blank.html")});this._panel.appendChild(this._iframe);},saveRect:function(C,F,D,E){C=parseInt(C,10);F=parseInt(F,10);D=parseInt(D,10);E=parseInt(E,10);if(!isNaN(C)){this.panelRect.left=C;}if(!isNaN(F)){this.panelRect.top=F;}if(!isNaN(D)){this.panelRect.width=D;}if(!isNaN(E)){this.panelRect.height=E;}return this.panelRect;},setPanelRect:function(C,F,D,E){Dom.setRect(this._panel,C,F,D,E);if(E==null&&D!=null){E=this.getPanelAutoHeight(D);}this.saveRect(C,F,D,E);return this;},setPanelSize:function(C,D){this.saveRect(null,null,C,D);Dom.setSize([this._panel],C,D);return this;},setPanelXY:function(C,D){this.saveRect(C,D);Dom.setXY(this._panel,C,D);return this;},setPanelFullscreen:function(){Dom.setFullscreen(this._panel);return this;},getPanelAutoHeight:function(D){var C=this._panel;var F=Dom.getStyle(C,"display");Dom.setStyle(C,"width",D+"px");if(F=="none"){Dom.setStyle(C,"display","block");}var I=Dom.paddingWidth(C);var G=Dom.borderWidth(C);var E=I[0]+I[2]+G[0]+G[2];var H=C.offsetHeight-E;Dom.setStyle(C,"display",F);return H;},setPanelCenter:function(C,D){if(!isNaN(parseInt(C))){D=this.getPanelAutoHeight(C);}this.saveRect(null,null,C,D);Dom.setCenter([this._panel],C,D);return this;},appendToPanel:function(C){this._panel.appendChild(C);},appendToContent:function(C){this._inner.appendChild(C);},showPanel:function(C,H,D,F,E){E=$(E);if(Dom.isElement(E)){C=parseInt(C,10)||0;H=parseInt(H,10)||0;var G=Dom.getAbsolutePosition(E);C+=G.left;H+=G.top;}this.setPanelRect.apply(this,arguments);this.setPanelVisible(true);},autoAdjustPanelPosition:function(){var E=Dom.getAbsolutePosition(this._panel);var C=Dom.borderWidth(this._panel);var D=Dom.getDocRect();if(E.left<D.scrollX){this.setStyle({left:D.scrollX+"px"});}if(E.top<D.scrollY){this.setStyle({top:D.scrollY+"px"});}if(E.right>D.width+D.scrollX){this.setStyle({left:(D.width+D.scrollX-E.width-C[1]-C[3])+"px"});}if(E.bottom>D.height+D.scrollY){this.setStyle({top:(D.height+D.scrollY-E.height-C[0]-C[2])+"px"});}},setPanelVisible:function(C,D){C=(C===false?"none":"block");if("block"===C&&!D){Dom.setStyle(this._panel,"zIndex",B++);}Dom.setStyle(this._panel,"display",C);},hidePanel:function(){this.setPanelVisible(false);},renderPanel:function(C){var D=Dom.getElementsByClassName(this.INNER_CLASS,C);if(!D||!Dom.isElement(D[0])){throw new Error(["Panel","render error","Panel inner is not a HTMLElement!"]);}this._panel=C;this._inner=D[0];return this;},detectPanel:function(){if(!this._panel||!!!$(this._panel.id)){alert('很抱歉，弹出层无法正常使用。\n可能是由于浏览器开启了"浮动广告拦截功能"，请尝试关闭该功能后重试。\n\n如何关闭"浮动广告拦截功能"请参阅帮助中心FAQ。');this.dispose();return false;}return true;},disposePanel:function(){Dom.removeNode(this._iframe);Dom.removeNode(this._inner);Dom.removeNode(this._panel);this._iframe=this._inner=this._panel=null;if("function"==typeof CollectGarbage){CollectGarbage();}},detect:function(){return this.detectPanel();},show:function(){if(!this.detect()){return ;}this.showPanel();if(!this.detect()){return ;}},render:function(){this.renderPanel.apply(this,arguments);},contains:function(C){return Dom.contains(this._panel,C);},hide:function(){return this.hidePanel();},dispose:function(){return this.disposePanel();},isVisible:function(){return this._visible;}};})();function BasePopup(B,A){this.initPopup.apply(this,arguments);return this;}BasePopup.prototype=(function(){return{center:false,shadow:false,cue:false,corner:false,resizable:false,draggable:false,buttons:null,header:true,body:true,footer:true,className:"panel-t2",width:null,height:null,left:null,top:null,useIframe:null,close:false,useEscKey:false,autoPosition:true,caption:"",content:"",_popup:null,_header:null,_body:null,_footer:null,_close:null,_resize:null,_shadow:null,_cue:null,_oDD:null,_corners:[],_initialized:false,_timer:null,_delay:300,_visible:false,BD_CLASS:"bd",FT_CLASS:"ft",HD_CLASS:"hd",SHADOW_CLASS:"shadow",CLOSE_CLASS:"close",RESIZE_CLASS:"resize",initPopup:function(B,A){if(Dom.isElement(B)){this.render(B);Object.extendJson(this,A||{});}else{this.applyConfig(B);}this._addPopupEvent();this._initialized=true;return this;},getPopup:function(){return this._popup._panel;},_addPopupEvent:function(){var B=this;var A=function(){B._timer=setTimeout(function(){clearTimeout(B._timer);if(!B.isVisible()){return ;}CustEvent.fireEvent(B,"windowresize");},B._delay);};var C=function(E){E=window.event||E;keycode=E.keyCode||E.which;if(keycode==27&&B.useEscKey){B.hide();}};var D=function(E){B.dispose();};if(!BB.Browser.mozilla){BBEvent.observe(window,"unload",D);}BBEvent.observe(window,"resize",A);BBEvent.observe(document,"keydown",C);},removeElements:function(){Dom.removeNode([this._corners[0],this._corners[1],this._resize,this._shadow,this._cue,this._close]);if(this._footer){this._footer.innerHTML="";}},createContainer:function(){if(this._initialized==false){if(this.useIframe!=null){useIframe=this.useIframe;}else{useIframe=BB.Browser.ie&&BB.Browser.version<7;}this._popup=new Panel({useIframe:useIframe});this._popup.setStyle("position","absolute");if(this.header){this._header=Dom.createElement("div","className",this.HD_CLASS);this._popup.appendToContent(this._header);}if(this.body){this._body=Dom.createElement("div","className",this.BD_CLASS);this._popup.appendToContent(this._body);}if(this.footer){this._footer=Dom.createElement("div","className",this.FT_CLASS);this._popup.appendToContent(this._footer);}}this._popup.resetClassName();this._popup.addClassName(this.className);},appendToBody:function(A){this._body.appendChild(A);},appendToHeader:function(A){this._header.appendChild(A);},appendToFooter:function(A){this._footer.appendChild(A);},initDraggable:function(){},applyConfig:function(B){this.removeElements();Object.extendJson(this,B);this.createContainer();this.createButtons();this.createCorners();this.createDirArrow();this.createShadow();this.createCloseBtn();if(this.caption){this.setCaption(this.caption);}if(this.content){this.setContent(this.content);}try{this.createResizable();this.initDraggable();}catch(A){CustEvent.fireEvent(this,"exception",{message:"BasePopup",description:A.message+"\n DragDrop.js not loaded"});}return this;},createButtons:function(){if(this.buttons&&this._footer){var C=this.buttons;var A=C.length;for(var B=0;B<A;B++){Dom.appendElement(this._footer,Dom.createElement("button",C[B]));}}},createResizable:function(){if(this.resizable){var A=this;this._resize=Dom.createElement("span","className",this.RESIZE_CLASS);this._popup.appendToPanel(this._resize);this._resize.onmouseover=function(){this.style.cursor="se-resize";};this._rsz=new DDProxy({sourceEl:this._popup.getPanel(),handleEl:this._resize});this._rsz.resizeSize=true;CustEvent.observe(this._rsz,"dragStart",function(){A._rsz.minWdith=A._popup.panelRect.width;});CustEvent.observe(this._rsz,"dragEnd",function(){});}},createCloseBtn:function(){if(this.close){var A=this;this._close=Dom.createElement("span","className",this.CLOSE_CLASS);var B=function(){A.hide();};BBEvent.observe(this._close,"click",B);this._popup.appendToPanel(this._close);}},createShadow:function(){if(this.shadow){this._shadow=Dom.createElement("span","className","sd");this._popup.appendToPanel(this._shadow);}},createCorners:function(){if(this.corner){this._corners[0]=Dom.createElement("span","className","co1");this._corners[1]=Dom.createElement("span","className","co2");this._corners[0].innerHTML=this._corners[1].innerHTML="<span></span>";this._popup.appendToPanel(this._corners[0]);this._popup.appendToPanel(this._corners[1]);}},createDirArrow:function(){if(this.cue){this._cue=Dom.createElement("span","className","cue");this._popup.appendToPanel(this._cue);}},setContent:function(A){if(typeof A=="object"){this._body.innerHTML="";this.appendToBody(A);}else{this._body.innerHTML=A;}return this._body;},setCaption:function(A){if(this._header){this._header.innerHTML="<h3>"+A+"</h3>";}},setHeader:function(A){this.setCaption(A);},setFooter:function(A){if(this._footer){this._footer.innerHTML=A;}},setPopupCenter:function(A,B){this._popup.setPanelCenter(A,B);return this._popup;},showPopup:function(A,E,B,D,C){A=A||this.left;E=E||this.top;B=B||this.width;D=D||this.height;this._popup.showPanel(A,E,B,D,C);if(this.center&&!Dom.isElement(C)){A=A||B||this._popup.panelRect.width;E=E||D||this._popup.panelRect.height;this.setPopupCenter(A,E);}if(!this.center&&this.autoPosition){this.adjustPosition();}if(isNaN(parseInt(B,10))){B=this._popup._panel.offsetWidth;Dom.setStyle(this._shadow,"width",B);}return this._popup;},renderPopup:function(B){this._popup=new Panel(B);this._popup.setStyle("position","absolute");var F=this;var A=parseInt(Dom.getStyle(B,"width"),10)||0;if(A){this.width=A;}var G=Dom.getElementsByClassName(this.SHADOW_CLASS,B);var C=Dom.getElementsByClassName(this.HD_CLASS,B);var D=Dom.getElementsByClassName(this.BD_CLASS,B);var H=Dom.getElementsByClassName(this.FT_CLASS,B);var I=Dom.getElementsByClassName(this.CLOSE_CLASS,B);if(!D){throw new Error(["Popup","render error","Panel body HTMLElement can not be rendered!"]);}this._shadow=G?G[0]:null;this._header=C?C[0]:null;this._body=D?D[0]:null;this._footer=H?H[0]:null;this._close=I?I[0]:null;if(this._close){var E=function(){F.hide();};BBEvent.observe(this._close,"click",E);}return this;},hidePopup:function(){this._popup.hidePanel();return this._popup;},getRect:function(){return this._popup.panelRect;},getBounds:function(){return this.getRect();},setPopupRect:function(){return this._popup.setPanelRect.apply(this._popup,arguments);},adjustPosition:function(){this._popup.autoAdjustPanelPosition();},disposePopup:function(){Dom.removeNode([this._header,this._body,this._footer,this._cue,this._shadow,this._resize,this._close,this._corners[0],this._corners[1]]);if(this._popup){this._popup.disposePanel();}this._header=this._body=this._footer=null;this._cue=this._shadow=this._resize=this._close=null;if("function"==typeof CollectGarbage){CollectGarbage();}},detectPopup:function(){var A=this._popup.detectPanel();if(!A){this.dispose();}return A;},show:function(){if(!this.detect()){return ;}CustEvent.fireEvent(this,"beforeshow");this.showPopup.apply(this,arguments);this._visible=true;CustEvent.fireEvent(this,"aftershow");if(!this.detect()){return ;}},detect:function(){return this.detectPopup();},hide:function(){if(!this.detect()){return ;}CustEvent.fireEvent(this,"beforehide");this.hidePopup();this._visible=false;CustEvent.fireEvent(this,"afterhide");if(!this.detect()){return ;}},contains:function(A){return this._popup.contains(A);},isVisible:function(){return this._visible;},render:function(){return this.renderPopup.apply(this,arguments);},dispose:function(){this.disposePopup();}};})();var LayerPopup=function(A){this.$super.apply(this,arguments);this._addLayerPopupListener();if(this.timeoutListener){this._initTimeoutListener();}return this;}.$extends(BasePopup);Object.extendJson(LayerPopup.prototype,(function(){return{hideTimeout:500,showTimeout:500,hideTimer:null,timeoutListener:false,_isInitTimeoutLsr:false,showTimer:null,_addLayerPopupListener:function(){var A=this;var B=function(D){D=window.event||D;var C=BBEvent.target(D);if(!A._popup.contains(C)&&A.isVisible()){if(A.isVisible()){CustEvent.fireEvent(A,"blur");A.hide();}}};CustEvent.observe(this,"aftershow",function(){BBEvent.stopObserving(document,"mousedown",B);BBEvent.stopObserving(document,"keyup",B);BBEvent.observe(document,"mousedown",B);BBEvent.observe(document,"keyup",B);});},_initTimeoutListener:function(){if(!this._isInitTimeoutLsr){var A=this;BBEvent.observe(this.getPopup(),"mouseover",function(){CustEvent.fireEvent(A,"aftermouseover");A.clearAllTimeout();});BBEvent.observe(this.getPopup(),"mouseout",function(){CustEvent.fireEvent(A,"aftermouseout");A.delayHide();});this._isInitTimeoutLsr=true;}},delayHide:function(B){this._initTimeoutListener();this.hideTimeout=parseInt(B,10)||this.hideTimeout;this.clearAllTimeout();var A=this;this.hideTimer=setTimeout(function(){A.hide();},this.hideTimeout);},delayShow:function(){this._initTimeoutListener();var A=this;var B=arguments;this.clearAllTimeout();this.showTimer=setTimeout(function(){A.show.apply(A,B);},this.showTimeout);},clearAllTimeout:function(){clearTimeout(this.hideTimer);clearTimeout(this.showTimer);},show:function(){if(!this.detect()){return ;}this.clearAllTimeout();CustEvent.fireEvent(this,"beforeshow");this.showPopup.apply(this,arguments);this._visible=true;CustEvent.fireEvent(this,"aftershow");if(!this.detect()){return ;}},hide:function(){this.clearAllTimeout();CustEvent.fireEvent(this,"beforehide");this.hidePopup();this._visible=false;CustEvent.fireEvent(this,"afterhide");}};})());var Dialog=function(A){A=A||{};this._initDialog(A);return this;}.$extends(BasePopup);Object.extendJson(Dialog.prototype,{close:true,modal:true,fixedMaskFs:true,center:true,shadow:true,useEscKey:true,header:true,body:true,footer:true,content:"",caption:"",_mask:null,MASK_CLASS:"mask",_initDialog:function(C){var B=false;this._mask=new Panel({useIframe:!!window.ActiveXObject});this._mask.addClassName(this.MASK_CLASS);this._mask.setStyle("position","absolute");C.className=C.className||"panel-t1";C.useIframe=C.useIframe||false;this.$super(C);this._addPopupEvent();var A=this;CustEvent.observe(this,"windowresize",function(){if(A.fixedMaskFs){A.setMaskFullscreen();}});return this;},setMaskFullscreen:function(){this._mask.setPanelFullscreen();},setDialogCenter:function(A,E,B,D,C){this.setPopupCenter.apply(this,arguments);},showDialog:function(A,E,B,D,C){if(this.modal){this._mask.showPanel();}else{this._mask.hidePanel();}this.showPopup(A,E,B,D,C);if(this.fixedMaskFs){this._mask.setPanelFullscreen();}return this;},setDialogRect:function(){return this.setPopupRect.apply(this,arguments);},showMask:function(){this._mask.showPanel.apply(this._mask,arguments);return this._mask;},hideMask:function(){this._mask.hidePanel();return this._mask;},hideDialog:function(){this.hidePopup();this.hideMask();},show:function(){if(!this.detect()){return ;}CustEvent.fireEvent(this,"beforeshow");this.showDialog.apply(this,arguments);this._visible=true;CustEvent.fireEvent(this,"aftershow");if(!this.detect()){return ;}},hide:function(){CustEvent.fireEvent(this,"beforehide");this.hideDialog();this._visible=false;CustEvent.fireEvent(this,"afterhide");},dispose:function(){this.disposePopup();this._mask.dispose();}});