Ext.onReady(function(){	Ext.BLANK_IMAGE_URL = '../../resources/ext/resources/images/default/s.gif';	Ext.QuickTips.init();	    Ext.state.Manager.setProvider(new Ext.state.CookieProvider());				var newLineHtml;	var newLinePanel;	var commendLineHtml;	var commendLinePanel;	var orderRemindHtml;	var orderRemindPanel;	var orderCountHtml;	var orderCountPanel;//	var documentHtml;//	var documentPenel;//	var financeHtml;//	var financePanel;	var noticeHtml;	var noticePanel;	var messageHtml;	var messagePanel;	var partmentHtml;	var partmentPanel;	var HQHtml;	var HQPanel;	//	doInfAajx();}); function doInfAajx() {		Ext.Ajax.request({			url : 'getMainPageInf.shtml',			method : 'POST',			success: function(result,request) { 				initData(result);			},			failure: function ( result, request) { 				Ext.MessageBox.alert('加载错误','菜单信息加载失败！'); 				window.close();			} 		});	}	function initData(result){  var resultJosn = doJSON(result.responseText);  if (resultJosn.success === true) {		initView(resultJosn);	}	else {		Ext.MessageBox.alert('加载失败', resultJosn.msg);	}  }function initView(list){		initPanel(list);		var header = new Ext.BoxComponent({ // raw                    region:'north',                    el: 'north',					margins:'5 0 0 5',                    height:32                });		var viewport = new Ext.Viewport({		layout: 'border',		items: [		 {		 	xtype: 'portal',			margins:'0 0 0 5',		 	region: 'center',		 	items: [{		 		columnWidth: .5,		 		style: 'padding:10px 0 10px 10px',		 		defaults: {		 			style: 'padding:0 0 10px 0'		 		},		 		items: [newLinePanel, commendLinePanel,  noticePanel, partmentPanel]		 	}, {		 		columnWidth: .5,		 		style: 'padding:10px',		 		defaults: {		 			style: 'padding:0 0 10px 0'		 		},		 		items: [orderRemindPanel, orderCountPanel, messagePanel, HQPanel]		 	}]		 }]	});}function initPanel(list){	newLineHtml=initNewLinePanel(list.newLineList);		newLinePanel={		title: '最新线路',		collapsible:true,		items: [{			html: newLineHtml		}]	};		commendLineHtml=initCommendLinePanel(list.commendLineList);		commendLinePanel={		title: '推荐线路',		frame:true,		collapsible:true,		items: [{			html: commendLineHtml		}]	};		orderRemindHtml=initOrderRemindPanel(list.orderCount);	orderRemindPanel={		title: '订单提醒',		frame:true,		collapsible:true,		items: [{			html: orderRemindHtml		}]	};		orderCountHtml=initOrderCountPanel(list.orderCount);	orderCountPanel={		title: '订单统计',		frame:true,		collapsible: true,		items: [{			html: orderCountHtml		}]	};	//	documentHtml=initDocumentPenel();	//	documentPenel={//		title: '报价文档',//		frame:true,//		collapsible:true,//		items: [{//			html: documentHtml//		}]//	};	//	financeHtml=initFinancePanel();	//	financePanel={//		title: '财务统计',//		frame:true,//		collapsible:true,//		collapsed:true,//		items: [{//			html: financeHtml//		}]//	};		noticeHtml=initNoticePanel(list.noticeList);	noticePanel={		title: '通告信息',		frame:true,		collapsible:true,		items: [{			html: noticeHtml		}]	};		messageHtml=initMessagePanel();	messagePanel={		title: '系统通知',		frame:true,		collapsible: true,		collapsed:true,		items: [{			html: messageHtml		}]	};		partmentHtml=initPartmentPanel(list.webConfig);	partmentPanel={		title: '分部信息',		frame:true,		collapsible:true,		collapsed:true,		items: [{			html: partmentHtml		}]	};		HQHtml=initHQPanel(list.company);	HQPanel={		title: '总部信息',		frame:true,		collapsible: true,		collapsed:true,		items: [{			html: HQHtml		}]	};}function initNewLinePanel(list){	var k;	if(list.length>5){		k = 5;	}	else{		k = list.length;	}	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;	var teamStr='',picLink='',picType,color='red';		for(i=0;i<k;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls2">';				if (list[i].theme !== '') {					picLink = '../../'+list[i].picUrl;					picType=list[i].theme;				}						if(picLink!==''){					teamStr='<img src=\"'+picLink+'\" height="12px" style="border:0;padding:0;margin:0;" />&nbsp;<font style="color:'+color+';">['+picType+']</font>&nbsp;';				}				tempHtml+=teamStr;		tempHtml+='<a href="#" onclick="printTeam(\'';		tempHtml+=list[i].teamId;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].flag;//		tempHtml+='\'';		//		tempHtml+=',';//		tempHtml+='\'';//		tempHtml+=list[i].ticket.status;		tempHtml+='\') ">'+list[i].teamName+'</a><img src="../../resources/images/share/yeoou/new.gif" />&nbsp;</td>';		tempHtml+='<td class="main_panel_cls3">'+list[i].startDateStr+'</td>';		tempHtml+='<td class="main_panel_cls4"><a href="#" onclick="signUp(\'';		tempHtml+=list[i].teamId;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].flag;		tempHtml+='\'';				tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].status;		tempHtml+='\') ">'+list[i].status+'</a></td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}function signUp(teamId,flag,status){	if(status==='可预定'){		if(flag>=4){			window.open('../team/getBookFreeTeam.shtml?teamId='+teamId);		}		else{			window.open('../team/getBookTeam.shtml?teamId='+teamId);		}			}	else{		Ext.Msg.alert('信息提示','次线路已满，请选择可以预订线路！')	}	}function printTeam(teamId,flag){//	if(status==='可预定'){		if(flag>=4){			window.open('../team/getPrintFreeTeam.shtml?teamId='+teamId);		}		else{			window.open('../team/getPrintTeam.shtml?teamId='+teamId);		}		//	}//	else{//		Ext.Msg.alert('信息提示','次线路已满，请选择可以预订线路！')//	}	}function initCommendLinePanel(list){	var k;	if(list.length>5){		k = 5;	}	else{		k = list.length;	}	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;	var teamStr='',picLink='',picType,color='red';		for(i=0;i<k;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls2">';				if (list[i].theme !== '') {					picLink = '../../'+list[i].picUrl;					picType=list[i].theme;				}						if(picLink!==''){					teamStr='<img src=\"'+picLink+'\" height="12px" style="border:0;padding:0;margin:0;" />&nbsp;<font style="color:'+color+';">['+picType+']</font>&nbsp;';				}				tempHtml+=teamStr;		tempHtml+='<a href="#" onclick="printTeam(\'';		tempHtml+=list[i].teamId;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].flag;		tempHtml+='\') ">'+list[i].teamName+'</a><img src="../../resources/images/share/yeoou/hot.gif" />&nbsp;</td>';		tempHtml+='<td class="main_panel_cls3">'+list[i].startDateStr+'</td>';		tempHtml+='<td class="main_panel_cls4"><a href="#" onclick="signUp(\'';		tempHtml+=list[i].teamId;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].flag;		tempHtml+='\'';				tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i].status;		tempHtml+='\') ">'+list[i].status+'</a></td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}function initOrderRemindPanel(list){		var orderName= new Array();	orderName=['新订单','已确认，待合同','已合同，待付款','已付款成功','完成订单','失效订单'];	var orderInf = new Array();	orderInf[0]=list.newOrder;	orderInf[1]=list.affirmed;	orderInf[2]=list.compact;	orderInf[3]=list.payment;	orderInf[4]=list.finish;	orderInf[5]=list.disable;	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		for(i=0;i<6;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls2">'+orderName[i]+'</td>';		tempHtml+='<td class="main_panel_cls5">'+orderInf[i]+'条</td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}function initOrderCountPanel(list){	var orderName= new Array();	orderName=['最新订单','本周订单','本月订单','订单总数'];	var orderInf = new Array();	orderInf[0]=list.day;	orderInf[1]=list.week;	orderInf[2]=list.month;	orderInf[3]=list.total;	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		for(i=0;i<4;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls2">'+orderName[i]+'</td>';		tempHtml+='<td class="main_panel_cls5">'+orderInf[i]+'条</td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}//function initDocumentPenel(){//	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';//	var tempHtml;//	//	for(i=0;i<5;i++){//		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';//		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';//		tempHtml+='<td class="main_panel_cls2"><a href="#" onclick="ViewLineDetail(233420);">第'+i+'条线路</a></td>';//		tempHtml+='<td class="main_panel_cls3">2008-10-12</td>';//		tempHtml+='<td class="main_panel_cls4">可预订</td>';//判断是否可以报名//		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';//		t+=tempHtml;//	}//	//	t+='</table>';//	return t;//}//function initFinancePanel(){//	var k=0;//	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';//	var tempHtml;//	//	for(i=0;i<5;i++){//		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';//		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';//		tempHtml+='<td class="main_panel_cls2"><a href="#" onclick="ViewLineDetail(233420);">第'+i+'条线路</a></td>';//		tempHtml+='<td class="main_panel_cls3">2008-10-12</td>';//		tempHtml+='<td class="main_panel_cls4">可预订</td>';//判断是否可以报名//		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';//		t+=tempHtml;//	}//	//	t+='</table>';//	return t;//}function initNoticePanel(list){	var k;	if(list.length>5){		k = 5;	}	else{		k = list.length;	}	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		for(i=0;i<k;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls2"><a href="#" onclick="showNoticeData(\'';		tempHtml+=list[i][0].name;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i][0].content;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i][0].addDateStr;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i][0].docName;		tempHtml+='\'';		tempHtml+=',';		tempHtml+='\'';		tempHtml+=list[i][0].docUrl;		tempHtml+='\') ">'+list[i][0].name+'</td>';				tempHtml+='<td class="main_panel_cls3">'+list[i][0].addDateStr+'</td>';		tempHtml+='<td class="main_panel_cls4"></td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}function showNoticeData(name,content,addDateStr,docName,docUrl){		var t='<table  width="100%" style="margin-bottom:30px" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		tempHtml='<tr>';	tempHtml+='<td class="notice_panel_cls1">';	tempHtml+=name;	tempHtml+='</td></tr>';	tempHtml+='<tr>';	tempHtml+='<td class="notice_panel_cls2">';	tempHtml+=addDateStr;	tempHtml+='</td></tr>';	tempHtml+='<tr>';	tempHtml+='<td class="notice_panel_cls3">&nbsp;&nbsp;&nbsp;&nbsp;';	tempHtml+=content;	tempHtml+='</td></tr>';	t+=tempHtml;		t+='</table>';		var showPanel = new Ext.Panel({		layout: 'form',		bodyStyle: 'padding:10px',		autoScroll: true,		height: 290,				items: [{			html:t		}]	});		if(docUrl!==''){		var urls = new Array();		urls = docUrl.split('@@@');		var docNames=new Array();		docNames=docName.split('@@@');		for(i=0;i<urls.length;i++){			addDownload(showPanel,urls[i],docNames[i],i+1);		}	}		showWin = new Ext.Window({			title: '查看公告信息',			id: 'showW',			closable: true,			width: 480,			height: 360,			modal: true,			layout: 'fit',			items: [showPanel]		});		showWin.show();}function addDownload(panel, url,docN,i){	docN=docN.substr(0,docN.indexOf('.'));	var fileUrl = '../../' + url;	var htmlStr = '<a target="_blank" href=\"' + fileUrl;	htmlStr += '\">';	htmlStr += docN;	htmlStr += '</a>';		panel.add({		xtype: 'fieldset',		title: '第' + i + '份文件',		id: i + 'doc',		autoHeight: true,		collapsed: false,		items: [{			html: htmlStr		}]	});	id++;	panel.show();	panel.doLayout();}function initMessagePanel(){}function initPartmentPanel(list){	var partName= new Array();	partName=['负责人','电话','手机','传真','QQ号码','MSN','电子邮件','地址','旅行社全称','工商营业执照','旅行社经营许可证','帐号信息'];	var partInf = new Array();	partInf[0]=list.manager;	partInf[1]=list.phone;	partInf[2]=list.mobile;	partInf[3]=list.fax;	partInf[4]=list.qq;	partInf[5]=list.msn;	partInf[6]=list.email;	partInf[7]=list.address;	partInf[8]=list.fullName;	partInf[9]=list.licenseNo;	partInf[10]=list.tripLicenseNo;	partInf[11]=list.account;	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		for(i=0;i<10;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls6">'+partName[i]+':</td>';		tempHtml+='<td class="main_panel_cls7">'+partInf[i]+'</td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}function initHQPanel(list){	var comName= new Array();	comName=['总部名称','负责人','描述','电话','MSN号码','QQ号码','电子邮件','地址'];	var comInf = new Array();	comInf[0]=list.name;	comInf[1]=list.manager;	comInf[2]=list.desc;	comInf[3]=list.phone;	comInf[4]=list.msn;	comInf[5]=list.qq;	comInf[6]=list.email;	comInf[7]=list.address;	var t='<table  width="100%" border="0" cellpadding="0" cellspacing="0" align="center">';	var tempHtml;		for(i=0;i<8;i++){		tempHtml='<tr><td class="main_panel_cls1">&nbsp;</td>';		tempHtml+='<td class="main_panel_cls1"><img src="../../resources/images/jobber/yeoou/main_arrow.gif" /></td>';		tempHtml+='<td class="main_panel_cls6">'+comName[i]+':</td>';		tempHtml+='<td class="main_panel_cls7">'+comInf[i]+'</td>';		tempHtml+='<td class="main_panel_cls1">&nbsp;</td></tr>';		t+=tempHtml;	}		t+='</table>';	return t;}